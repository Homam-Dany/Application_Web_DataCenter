document.addEventListener("DOMContentLoaded",function(){document.querySelectorAll(".btn-decision-accept").forEach(t=>{t.addEventListener("click",()=>{const i=t.dataset.id;window.submitDecision(i,"accepter")})}),document.querySelectorAll(".btn-decision-refuse").forEach(t=>{t.addEventListener("click",()=>{const i=t.dataset.id;window.handleRefusal(i)})});const e=document.getElementById("toggle-history-btn"),o=document.getElementById("history-section"),n=document.getElementById("toggle-text");e&&e.addEventListener("click",function(){if(o.style.display==="none")o.style.display="block",setTimeout(()=>{o.style.opacity="1"},10),n&&(n.textContent="Masquer l'historique"),e.style.background="var(--primary)",e.style.color="white";else{o.style.opacity="0",setTimeout(()=>{o.style.display="none"},400);const t=e.dataset.count;n&&(n.textContent=`Voir l'historique (${t})`),e.style.background="var(--bg-card)",e.style.color="var(--primary)"}})});window.submitDecision=function(e,o){const n=document.getElementById("decision-form-"+e);if(!n)return;const t=n.dataset.url;n.action=t+"/"+e+"/"+o,n.submit()};window.handleRefusal=function(e){const o=document.getElementById("rejection-area-"+e),n=document.getElementById("reason-input-"+e),t=document.getElementById("refuse-btn-"+e);if(!(!o||!n||!t))if(o.style.display==="none")o.style.display="block",t.innerHTML='<i class="fas fa-paper-plane"></i> Confirmer le refus',t.style.backgroundColor="white",t.style.color="#ef4444",t.style.border="2px solid #ef4444",n.focus();else{if(n.value.trim().length<5){alert("Veuillez saisir un motif de refus valide (5 caractÃ¨res min).");return}submitDecision(e,"refuser")}};
