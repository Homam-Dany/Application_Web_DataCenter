document.addEventListener("DOMContentLoaded",function(){const e=document.getElementById("toggle-history-btn"),n=document.getElementById("history-section"),t=document.getElementById("toggle-text");e&&e.addEventListener("click",function(){if(n.style.display==="none")n.style.display="block",setTimeout(()=>{n.style.opacity="1"},10),t&&(t.textContent="Masquer l'historique"),e.style.background="var(--primary)",e.style.color="white";else{n.style.opacity="0",setTimeout(()=>{n.style.display="none"},400);const o=e.dataset.count;t&&(t.textContent=`Voir l'historique (${o})`),e.style.background="var(--bg-card)",e.style.color="var(--primary)"}})});window.submitDecision=function(e,n){const t=document.getElementById("decision-form-"+e);if(!t)return;const o=t.dataset.url;t.action=o+"/"+e+"/"+n,t.submit()};window.handleRefusal=function(e){const n=document.getElementById("rejection-area-"+e),t=document.getElementById("reason-input-"+e),o=document.getElementById("refuse-btn-"+e);if(!(!n||!t||!o))if(n.style.display==="none")n.style.display="block",o.innerHTML='<i class="fas fa-paper-plane"></i> Confirmer le refus',o.style.backgroundColor="white",o.style.color="#ef4444",o.style.border="2px solid #ef4444",t.focus();else{if(t.value.trim().length<5){alert("Veuillez saisir un motif de refus valide (5 caractÃ¨res min).");return}submitDecision(e,"refuser")}};
